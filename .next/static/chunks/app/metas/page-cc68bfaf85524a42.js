(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{57389:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>n});var s=t(95155),l=t(12115),r=t(12108),i=t(35695);function n(){let{data:e,status:a}=(0,r.useSession)(),t=(0,i.useRouter)(),[n,o]=(0,l.useState)([]),[c,d]=(0,l.useState)(!0),[m,x]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!1),[b,g]=(0,l.useState)(null),[p,v]=(0,l.useState)(null),[f,j]=(0,l.useState)(""),[y,N]=(0,l.useState)(""),[w,C]=(0,l.useState)({total:0,ativas:0,concluidas:0,vencidas:0}),[A,k]=(0,l.useState)({nome:"",valorAlvo:"",dataAlvo:""}),[E,S]=(0,l.useState)({valor:"",descricao:""});(0,l.useEffect)(()=>{if("loading"!==a){if(!e)return void t.push("/login");D()}},[e,a,t]);let D=async()=>{try{let e=await fetch(y?"/api/metas?status=".concat(y):"/api/metas"),a=await e.json();e.ok?(o(a.metas),C(a.estatisticas)):j(a.error||"Erro ao carregar metas")}catch(e){j("Erro ao carregar metas")}finally{d(!1)}};(0,l.useEffect)(()=>{e&&D()},[y]);let M=async e=>{e.preventDefault(),d(!0);try{let e=await fetch(b?"/api/metas/".concat(b):"/api/metas",{method:b?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),a=await e.json();e.ok?(j(b?"Meta atualizada com sucesso!":"Meta criada com sucesso!"),F(),D()):j(a.error||"Erro ao salvar meta")}catch(e){j("Erro ao salvar meta")}finally{d(!1)}},T=async e=>{if(e.preventDefault(),p){d(!0);try{let e=await fetch("/api/metas/".concat(p.id,"/contribuir"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),a=await e.json();e.ok?(j(a.message),h(!1),S({valor:"",descricao:""}),D()):j(a.error||"Erro ao adicionar contribui\xe7\xe3o")}catch(e){j("Erro ao adicionar contribui\xe7\xe3o")}finally{d(!1)}}},O=e=>{g(e.id),k({nome:e.nome,valorAlvo:e.valorAlvo.toString(),dataAlvo:e.dataAlvo.split("T")[0]}),x(!0)},V=async(e,a)=>{if(confirm('Tem certeza que deseja excluir a meta "'.concat(a,'"?')))try{let a=await fetch("/api/metas/".concat(e),{method:"DELETE"}),t=await a.json();a.ok?(j("Meta exclu\xedda com sucesso!"),D()):j(t.error||"Erro ao excluir meta")}catch(e){j("Erro ao excluir meta")}},z=async e=>{try{let a=await fetch("/api/metas/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isCompleted:!e.isCompleted})}),t=await a.json();a.ok?(j(e.isCompleted?"Meta reaberta!":"Meta marcada como conclu\xedda!"),D()):j(t.error||"Erro ao atualizar meta")}catch(e){j("Erro ao atualizar meta")}},F=()=>{k({nome:"",valorAlvo:"",dataAlvo:""}),g(null),x(!1)},P=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),R=e=>new Date(e).toLocaleDateString("pt-BR"),_=(e,a)=>Math.min(e/a*100,100),q=e=>{let a=new Date;return Math.ceil((new Date(e).getTime()-a.getTime())/864e5)},B=e=>{if(e.isCompleted)return"text-green-600";let a=q(e.dataAlvo);return a<0?"text-red-600":a<=30?"text-yellow-600":"text-blue-600"},J=e=>{if(e.isCompleted)return"Conclu\xedda";let a=q(e.dataAlvo);return a<0?"Vencida":0===a?"Vence hoje":1===a?"Vence amanh\xe3":"".concat(a," dias restantes")};return"loading"===a||c?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Objetivos Financeiros"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Defina e acompanhe suas metas financeiras"})]}),(0,s.jsx)("button",{onClick:()=>x(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 shadow-lg",children:"+ Nova Meta"})]}),f&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-blue-100 border border-blue-400 text-blue-700 rounded-lg",children:[f,(0,s.jsx)("button",{onClick:()=>j(""),className:"float-right text-blue-700 hover:text-blue-900",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,s.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"text-3xl mr-4",children:"\uD83C\uDFAF"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total de Metas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:w.total})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"text-3xl mr-4",children:"\uD83D\uDD25"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Ativas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:w.ativas})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"text-3xl mr-4",children:"✅"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Conclu\xeddas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-600",children:w.concluidas})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"text-3xl mr-4",children:"⏰"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Vencidas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-red-600",children:w.vencidas})]})]})})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{onClick:()=>N(""),className:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 ".concat(""===y?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"Todas"}),(0,s.jsx)("button",{onClick:()=>N("ativas"),className:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 ".concat("ativas"===y?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"Ativas"}),(0,s.jsx)("button",{onClick:()=>N("concluidas"),className:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 ".concat("concluidas"===y?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"Conclu\xeddas"}),(0,s.jsx)("button",{onClick:()=>N("vencidas"),className:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 ".concat("vencidas"===y?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"Vencidas"})]})}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>{let a=_(e.currentAmount,e.valorAlvo);return(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow duration-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 flex-1",children:e.nome}),(0,s.jsx)("span",{className:"text-sm font-medium ".concat(B(e)),children:J(e)})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,s.jsx)("span",{children:"Progresso"}),(0,s.jsxs)("span",{children:[a.toFixed(1),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,s.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat(e.isCompleted?"bg-green-500":"bg-blue-500"),style:{width:"".concat(a,"%")}})})]}),(0,s.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Atual:"}),(0,s.jsx)("span",{className:"font-medium",children:P(e.currentAmount)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Meta:"}),(0,s.jsx)("span",{className:"font-medium",children:P(e.valorAlvo)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Restante:"}),(0,s.jsx)("span",{className:"font-medium text-blue-600",children:P(Math.max(0,e.valorAlvo-e.currentAmount))})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Prazo:"}),(0,s.jsx)("span",{className:"font-medium",children:R(e.dataAlvo)})]})]}),e.transacoes.length>0&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"\xdaltimas contribui\xe7\xf5es:"}),(0,s.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:e.transacoes.slice(0,3).map(e=>(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-gray-500",children:R(e.data)}),(0,s.jsxs)("span",{className:"text-green-600 font-medium",children:["+",P(e.valor)]})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[!e.isCompleted&&(0,s.jsx)("button",{onClick:()=>{v(e),h(!0)},className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors duration-200",children:"Contribuir"}),(0,s.jsx)("button",{onClick:()=>O(e),className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors duration-200",children:"Editar"}),(0,s.jsx)("button",{onClick:()=>z(e),className:"py-2 px-3 rounded-lg text-sm font-medium transition-colors duration-200 ".concat(e.isCompleted?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-green-600 hover:bg-green-700 text-white"),children:e.isCompleted?"Reabrir":"Concluir"}),(0,s.jsx)("button",{onClick:()=>V(e.id,e.nome),className:"bg-red-600 hover:bg-red-700 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors duration-200",children:"Excluir"})]})]},e.id)})}),0===n.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFAF"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Nenhuma meta encontrada"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Comece criando sua primeira meta financeira!"}),(0,s.jsx)("button",{onClick:()=>x(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200",children:"Criar Meta"})]}),m&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:b?"Editar Meta":"Nova Meta"}),(0,s.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Meta"}),(0,s.jsx)("input",{type:"text",value:A.nome,onChange:e=>k({...A,nome:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Viagem para Europa",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor Alvo"}),(0,s.jsx)("input",{type:"number",step:"0.01",min:"0.01",value:A.valorAlvo,onChange:e=>k({...A,valorAlvo:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0,00",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Alvo"}),(0,s.jsx)("input",{type:"date",value:A.dataAlvo,onChange:e=>k({...A,dataAlvo:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().split("T")[0],required:!0})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:F,className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-lg font-medium transition-colors duration-200",children:"Cancelar"}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium transition-colors duration-200 disabled:opacity-50",children:c?"Salvando...":b?"Atualizar":"Criar"})]})]})]})}),u&&p&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["Contribuir para: ",p.nome]}),(0,s.jsxs)("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Valor atual:"}),(0,s.jsx)("span",{className:"font-medium",children:P(p.currentAmount)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Meta:"}),(0,s.jsx)("span",{className:"font-medium",children:P(p.valorAlvo)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Restante:"}),(0,s.jsx)("span",{className:"font-medium text-blue-600",children:P(p.valorAlvo-p.currentAmount)})]})]}),(0,s.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor da Contribui\xe7\xe3o"}),(0,s.jsx)("input",{type:"number",step:"0.01",min:"0.01",value:E.valor,onChange:e=>S({...E,valor:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0,00",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o (opcional)"}),(0,s.jsx)("input",{type:"text",value:E.descricao,onChange:e=>S({...E,descricao:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Economia do m\xeas"})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{h(!1),S({valor:"",descricao:""})},className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-lg font-medium transition-colors duration-200",children:"Cancelar"}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-medium transition-colors duration-200 disabled:opacity-50",children:c?"Contribuindo...":"Contribuir"})]})]})]})})]})})}},81671:(e,a,t)=>{Promise.resolve().then(t.bind(t,57389))}},e=>{var a=a=>e(e.s=a);e.O(0,[454,441,684,358],()=>a(81671)),_N_E=e.O()}]);